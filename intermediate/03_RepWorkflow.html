<!DOCTYPE html>
<html>
  <head>
    <title>Reproducible Workflow with rmarkdown</title>
    <meta charset="utf-8">
    <meta name="author" content="Tyson S. Barrett" />
    <link href="libs/remark-css/example.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <script src="libs/jszip/jszip.min.js"></script>
    <script src="libs/pdfmake/pdfmake.min.js"></script>
    <script src="libs/pdfmake/vfs_fonts.js"></script>
    <link href="libs/dt-ext-buttons/css/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="libs/dt-ext-buttons/js/dataTables.buttons.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.flash.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.html5.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.colVis.min.js"></script>
    <script src="libs/dt-ext-buttons/js/buttons.print.min.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Reproducible Workflow with <code>rmarkdown</code>
## ðŸ˜®
### Tyson S. Barrett

---




class: inverse

# Outline

--

## What is "reproducibility"?

--

## How can `rmarkdown` help?

--

## Integrating `rmarkdown` into your workflow

--

## The Ins-and-Outs of `rmarkdown` 

---

# References

Goodman, SN, Fanelli, D, Ioannidis, JPA. (2016). What does reproducibility really mean? Science Translational Medicine, 8(341), 1-6.


---
class: inverse, middle, center
# Reproducibility
---

# Reproducibility

<div id="htmlwidget-94accc9a2e0b7f192260" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-94accc9a2e0b7f192260">{"x":{"filter":"none","data":[["Methods","Results","Inferential"],["Same data and same methods","Independent data (same population) and same methods","Same or independent data and same methods"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Reproducibility<\/th>\n      <th>Definition<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

--

This class will focus on **Methods Reproducibility**.

--

"Methods reproducibility refers to the provision of enough detail about study procedures and data so the same procedures could, in theory or in actuality, be exactly repeated," (Goodman et al., 2016).


---

# Methods Reproducibility

"Methods reproducibility refers to the provision of enough detail about study procedures and data so the same procedures could, in theory or in actuality, be exactly repeated," (Goodman et al., 2016).

--

Requires

- A replicable workflow.
- Avoidance of input/output errors.
- Documentation, documentation, documentation.
- Transparent reporting.
- A single raw data set from which all analyses are done.
- Code (in this class, `R` code!) that works with the raw data.
- Others?


---

# Methods Reproducibility and Rmarkdown

- A replicable workflow.
- Avoidance of input/output errors.
- Documentation, documentation, documentation.
- Transparent reporting.
- A single raw data set from which all analyses are done.
- Code (in this class, `R` code!) that works with the raw data.
- Others?

--

### Each can be aided by `rmarkdown` and its associated packages.

--

### We will demonstrate most of these throughout this course, but especially while we discuss `rmarkdown`.

---

# Benefits of rmarkdown

1. Input (code) and output (tables/figures) are intimately tied---NO MANUAL (ERROR-PRONE) TABLES!

1. Document type is flexible and easy to adjust.

1. Updates to the analyses and output are straightfoward---no need to keep track of 50+ little things to change.

--

1. Provides quick reports that can be shared across many platforms (Word, Latex, PDF, HTML).

1. Makes transparent reporting easier---the actual steps of analysis are right next to the write up about the actual steps.

1. If we use version control (e.g. *Git*), the file system is much simpler.

--

1. It's cool.

---
class: inverse, middle, center
# Integrating rmarkdown into your workflow

---

# If:
  
  - You are reporting findings
  - The analyses are iterative (report and re-analyze, report and re-analyze...)
  - Working with individuals that understand some Latex or Markdown

### Use Rmarkdown for the writing and reporting!

--

### It'll probably stretch you a bit as a researcher -- but that is a good thing. ðŸ¤—

---

class: middle, center

# Get one started!

...


---
class: inverse, middle, center

# The Ins-and-Outs of rmarkdown

---
class: middle, center
# RStudio has a [great website](http://rmarkdown.rstudio.com/lesson-1.html) that we will use to understand rmarkdown better.

---
# Main Pieces of RMarkdown

### `YAML`
### Code Chunks
### Plain text
### Inline Code

---
# YAML

**You Awesome Mammal Life**

Tells R:

1. Title, author, date
1. Type of document
1. Other magic tricks

.footnote[This is how you create a publishable report. We'll come back to it.]

---
# Code Chunks

These are treated as R code -- nothing more, nothing less.

There are several options. Some important ones:

1. `echo`
1. `message`
1. `warning`
1. `results`
1. `fig.xxxx`
1. `eval`

---
# Plain Text

The text of the document. Use Markdown code here.

.pull-left[
### Equations

##### Inline

`$ Y = \frac{1}{2} * X$`

##### Centered

`$$  
Y = \frac{1}{2} * X  
`$$`
]

.pull-right[
### Lists

`1. item one`  
`2. item two`  

`- unordered item one`  
`- unordered item two`  

### Images

`![](path/to/image.png)`
]

---
# Inline Code

You can insert R code into the plain text.

If we wanted to state the mean and SD of a variable, we can use:

```r
`r mean(x)` 
`r sd(x)`
```
right in line with our plain text.

---
class: inverse, middle, center

# Some final notes

---
background-image: url("https://www.rstudio.com/images/docs/projects_new.png")
background-position: 50% 80%
background-size: 600px

# Easiest Way to Integrate RMarkdown --&gt; RStudio Projects!


---
class: inverse, middle, center

# Pop Quiz Thing
## on the following slide

---

# Do the Following

1. Open a new Rmarkdown file with a title, author, and date.
2. Set global rmarkdown options to `echo=TRUE`, `warning=FALSE`, `message=FALSE`
2. Output should be set to HTML.
3. Load the following data (you can download it by pressing the CSV button).
4. Print a summary table of the data (any summary that you'd like).
5. Knit the document.

<div id="htmlwidget-88ed40d426ecb2feb88b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-88ed40d426ecb2feb88b">{"x":{"filter":"none","extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[0.524114223429933,0.316050061257556,0.458011375274509,0.279881064547226,0.89097217656672,0.135460910154507,0.185300006531179,0.00759075814858079,0.442026723641902,0.726312251761556,0.105728719616309,0.920757909771055,0.410189062589779,0.44562591961585,0.319275623187423,0.184684969251975,0.722481941105798,0.72084895754233,0.675341116962954,0.0228325540665537,0.993258272996172,0.38565219566226,0.271920886822045,0.0975612383335829,0.771375883603469,0.688331011915579,0.116843451280147,0.888626462779939,0.952204938745126,0.306761070620269,0.747467017034069,0.268170261755586,0.874311761697754,0.945596941513941,0.550684698857367,0.640254588797688,0.0614701379090548,0.138257262762636,0.301202015485615,0.382879788754508,0.174420448485762,0.37121288315393,0.746694692177698,0.261955662397668,0.894517801469192,0.183304422767833,0.770841100951657,0.04405866866,0.705065769376233,0.438752482412383,0.591929686954245,0.665294690523297,0.261450397782028,0.318783775670454,0.79735040711239,0.820617747493088,0.045077851973474,0.568199075059965,0.271282205590978,0.58882059995085,0.322268073214218,0.799162488430738,0.238754177698866,0.894518326269463,0.902060442836955,0.517675903392956,0.453061954118311,0.0855856619309634,0.0957649999763817,0.319310436956584,0.957034717313945,0.843419080134481,0.691372061148286,0.200067978119478,0.376077976310626,0.20193903031759,0.783339554909617,0.762598279863596,0.776681679766625,0.208780442597345,0.517577722668648,0.816968933679163,0.108526235446334,0.420380052644759,0.41178957070224,0.641758521553129,0.156764755956829,0.0217283356469125,0.488657683134079,0.0754446326754987,0.493267380166799,0.435077197384089,0.617550954222679,0.0914784446358681,0.753877715673298,0.129542383830994,0.0984634004998952,0.511955806054175,0.73365390766412,0.926698433700949],[-0.265362310711747,0.928343238084958,-0.464055527761009,-0.776883075345303,-3.17488586740691,-3.95598554530225,0.544002653358143,0.490809556692754,0.508724770209346,-0.932094270451462,-0.338065188189599,1.07809678698958,0.438149115150298,-0.512459618033999,-0.752899904524844,-0.278518461500698,-0.135022727458398,0.889377557265404,0.761391871620371,1.21034359218382,2.65937996531828,0.98058214370084,-0.0380437981234661,-1.21223117716212,1.68123708094001,1.85716252924489,-0.168114778951357,1.60570710106611,-1.91637645923622,0.356825926978476,-0.890092200264216,0.11490639983955,-0.36297120874065,-0.351850014725657,0.220883212713078,0.386422974905611,0.977489238648879,0.278497316494881,1.09695216705159,-0.25814857528263,-0.85710325528061,-1.44004030589562,3.63003204766381,-0.465787480890805,-0.507863660180671,0.763987701003809,0.34246054793212,-0.303055701095261,0.809777687447781,-0.0867241040314181,0.118280364153225,-1.27570150211347,-0.487827581134983,1.02222483301583,0.831532941645669,1.06615863414634,-0.405060754873404,0.638550478597294,1.44759648566855,-0.777936066310229,2.20279505664478,-0.107301779482949,1.54341221308364,-1.34650725451514,0.727336313146293,0.00150473708395024,-0.70089309380789,-0.182749162009394,0.309674302437683,-0.416358323489026,1.08968604757754,-0.523004835371887,0.241753137300098,0.309580669658047,-2.25029766364164,-0.339963979277726,0.927908831934416,0.729003260231382,1.68726522637572,-1.70992802932722,0.352059481910216,-1.43239091969781,0.974949862404506,-1.1818533666086,1.1312254217048,0.602361972394759,-0.334883724863464,-1.45389701335597,-0.774195325058152,-0.59494517078853,-0.0648570409740978,0.0790981727916338,0.749736305379907,-0.755248113416364,1.28698226456152,-0.197514919197791,-0.791273534177707,-0.226102459363262,-0.115635368841263,-1.07660298767882],[0,0,1,1,1,0,1,1,1,1,0,1,0,1,1,0,1,1,0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,0,1,0,1,0,1,1,0,1,1,1,0,0,1,0,1,0,1,0,1,1,0,1,0,0,0,1,0,1,0,1,1,0,1,0,1,0,0,0,1,0,0,1,0,0,1,1,1,1,1,1,0,1,1,0,0,0,1,1,0,1],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>W<\/th>\n      <th>X<\/th>\n      <th>Y<\/th>\n      <th>id<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","excel","pdf","print"],"pageLength":5,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---
class: inverse, middle, center

# Tables and Figures in RMarkdown

---
# Tables

There are a few ways to get nice looking tables in Rmarkdown.

1. Output the console output (not as nice but still informative)
2. Output in HTML, Word, or Latex tables

### Good Packages

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Package &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Function &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Output &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; knitr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; kable() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Word, HTML, PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; DT &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; datatable() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; HTML &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; furniture &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; table1(), tableC() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Word, HTML, PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; stargazer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; stargazer() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; texreg &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; texreg() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PDF &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Tables

#### Text output with a few chunk options

```
                         Function          Output
     knitr                kable() Word, HTML, PDF
     DT               datatable()            HTML
     furniture table1(), tableC() Word, HTML, PDF
     stargazer        stargazer()             PDF
     texreg              texreg()             PDF
```

#### HTML output from kable()
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Package &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Function &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Output &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; knitr &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; kable() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Word, HTML, PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; DT &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; datatable() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; HTML &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; furniture &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; table1(), tableC() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Word, HTML, PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; stargazer &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; stargazer() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PDF &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; texreg &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; texreg() &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; PDF &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Tables

There are some add-ons for the packages, such as the `kableExtra` package that let's you make the kable table's look better.

--

### Some best practices:

1. Only print what you want to print (e.g., remove any `summary(df)`'s)
2. Only make it as pretty as is necessary (don't waste time making something look slightly better when the slightly better is not necessary)
3. Keep the tables small (long tables are not generally very useful to an audience)
4. If you use `kable()` or similar functions, provide a caption for the table
5. Don't be redundant in your table. Use the space for providing unique pieces of information.



---
# Figures

### Automatically including nice figures is a huge plus to using Rmarkdown

There are several code chunk options for the figures: `fig.xxxx` options.

### If you want more customizability:

.large[Can save the figure and use it within the same knitting process.]


---
class: inverse, middle, center

# Examples

---
# For more information about the code chunks:

.huge[
[https://yihui.name/knitr/options/](https://yihui.name/knitr/options/)
]
---
# YAML and Templates

Each type of document (Word, PDF, HTML) is entirely customizable

### HTML

If you are familiar with CSS code, then you can do a ton with the HTML document type

There are also downloadable templates that you can use

.footnote[All these are best packaged within an Rstudio Project!]

---
# YAML and Templates

Each type of document (Word, PDF, HTML) is entirely customizable

### Word Templates

Each Word document has specific styles that are default

You can change this and use that as the default look of your Word documents

.footnote[All these are best packaged within an Rstudio Project!]

---
# YAML and Templates

Each type of document (Word, PDF, HTML) is entirely customizable

### PDF

This is where I have the most experience (see my [dissertation proposal](http://tysonbarrett.com/assets/Manuscript/MarginalMediation_Proposal.pdf)).

I'll walk you through my dissertation project, including

1. The template file
2. The YAML code to use it
3. Other files I use

.footnote[All these are best packaged within an Rstudio Project!]


---
class: inverse, middle, center

# Questions about RMarkdown?
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {window.dispatchEvent(new Event('resize'));});
(function() {var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler"); if (!r) return; s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }"; d.head.appendChild(s);})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
